@dbTable(Q1,SELECT F91 FROM TMP_REC_BAT);

<pre>
@wizrpl(PO=@dbRow(Q1,F91));
@wizrpl(F1032A=@dbGen(F1032,1));

@dbExec(UPDATE TMP_REC_BAT SET F1032=@WIZGET(F1032A) WHERE F91='@WIZGET(PO)');

@dbExec(UPDATE TMP_REC_DTL SET F1032=@WIZGET(F1032A) WHERE F1032='@WIZGET(PO)');

@dbExec(UPDATE DTL SET DTL.F04=ISNULL(POS.F04,DTL.F04),DTL.F19=ISNULL(COST.F19,DTL.F19),DTL.F38=ISNULL(COST.F38,DTL.F38),DTL.F26=ISNULL(COST.F26,DTL.F26),DTL.F1140=ISNULL(COST.F1140,DTL.F1140),DTL.F1775 = ISNULL(PRICE.F30, DTL.F1775),DTL.F1771 = ISNULL(DTL.F64 * PRICE.F30, DTL.F1771) FROM TMP_REC_DTL DTL JOIN TMP_REC_BAT BAT ON BAT.F1032=DTL.F1032 LEFT JOIN POS_TAB POS ON POS.F01=DTL.F01 LEFT JOIN COST_TAB COST ON COST.F01=DTL.F01 AND COST.F27=BAT.F27 LEFT JOIN PRICE_TAB PRICE ON PRICE.F01=DTL.F01 WHERE DTL.F1032=@WIZGET(F1032A));
</pre>

@dbTable(Q2,SELECT F91,F1032 FROM TMP_REC_BAT);

<pre>
@wizrpl(PO=@dbRow(Q2,F91));
@wizrpl(F1032A=@dbRow(Q2,F1032,#));
@wizrpl(RECNAME=REC_@FMT(!0:9:0,@WIZGET(F1032A)));

@dbExec(UPDATE TMP_REC_BAT SET F1255='@WIZGET(RECNAME)' WHERE F1032=@WIZGET(F1032A));

@FMT(CMP,@dbHot(FINDTABLE,'@WIZGET(RECNAME)')=,,"®dbExec(DROP TABLE @WIZGET(RECNAME))");

@dbExec(SELECT * INTO @WIZGET(RECNAME) FROM REC_REG WHERE 1=0);

@dbExec(INSERT INTO @WIZGET(RECNAME) SELECT * FROM TMP_REC_DTL WHERE F1032=@WIZGET(F1032A));

@UPDATE_BATCH(JOB=ADDRPL,TAR=REC_BAT,KEY=F1032=:F1032,SRC=SELECT * FROM TMP_REC_BAT WHERE F1032=@WIZGET(F1032A));
</pre>
